# SQL requests Voronezh State University Semester 4

### Lab 1 - Retrieving Data Using the SQL SELECT Statement
- Отделу кадров требуется список сотрудников: фамилия, код должности, дата приема на работу и код сотрудника. Дату приема на работe назовите STARTDATE.
- Отделу кадров требуется список существующих кодов должностей из таблицы EMPLOYEES. Список не должен содержать одинаковых записей.
- Отделу кадров требуется список сотрудников: фамилия, код должности, дата приема на работу и код сотрудника. Дату приема на работу назовите «Hire Date». Код сотрудника назовите «Emp #». Фамилию назовите «Employee». Код должности назовите «Job».
- Отдел кадров запросил отчет по сотрудникам (фамилия) и занимаемым ими должностям. Вывод информации одной колонкой, названной «Employee and Title». Фамилия и должность разделяются запятой с пробелом.
- Отдел кадров запросил отчет по сотрудникам (фамилия), получаемой зарплате, зарплате в следующем году. Зарплата следующего года по условиям индексации увеличивается на 15%. Фамилию сотрудника назовите «Employee», зарплату следующего года – «Next Year Salary».
- Отдел кадров запросил информацию о заработке сотрудников компании за год. Зарплата у сотрудников в течении года не менялась. 
- Отдел кадров запросил информацию о заработке сотрудников компании за год. Зарплата у сотрудников в течении года не менялась. Требуется вывести эту информацию одной колонкой, названной «Total salary» в виде предложения «employee for the year received 200», где вместо employee – фамилия сотрудника, вместо 200 – заработок за год. Также, отдельной колонкой вывести зарплату с учетом персональной надбавки и назвать колонку «Premium salary». 
- Отдел кадров запросил информацию о зарплате сотрудников. Информация должна быть выведена одной колонкой по примеру «Steven’s salary is 2000».
- Отдел кадров запросил решил составить телефонный справочник сотрудников. Информация должна быть выведена одной колонкой по примеру «Steven King has phone number 234234».
- Отделу кадров требуется список существующих кодов подразделений из таблицы EMPLOYEES. Список не должен содержать одинаковых записей.

### Lab 2 - Restricting and Sorting Data
- Отделу кадров требуется список сотрудников (фамилия, имя), получающих зарплату более 12000$.
- Отделу кадров требуется узнать фамилию и подразделение у сотрудника с кодом 176.
- Отделу кадров требуется список сотрудников (фамилия, имя, зарплата, код департамента), не имеющих среднюю зарплату. Средняя зарплата находится в диапазоне от 5 до 12 тысяч. Используйте условие BETWEEN.
- Создайте отчет, показывающий фамилию сотрудника, код должности, дату принятия на работу у сотрудников с фамилиями Matos и Taylor. Используйте условие IN.
- Создайте отчет, показывающий фамилию сотрудника и код департамента у всех сотрудников из 20 и 50 департамента. Используйте условие IN.
- Отделу кадров требуется список сотрудников (фамилия, имя, зарплата, код департамента), имеющих среднюю зарплату. Средняя зарплата находится в диапазоне от 5 до 12 тысяч. Используйте условие BETWEEN. Назовите колонки Employee, Monthly Salary
- Отделу кадров требуется список сотрудников (Фамилия, код), которые были приняты в 1994 году.
- Создайте отчет для отображения фамилии и кода должности у сотрудников без начальника.
- Отобразите всех сотрудников (имя, фамилия, зарплата, величина надбавки), имеющих надбавку. Полученный список отсортируйте по убыванию зарплаты и надбавки.
- Отобразите всех сотрудников (имя, фамилия, зарплата), у которых зарплата больше 10000.
- Отобразите всех сотрудников (код, имя, фамилия, зарплата, подразделение), работающих в подчинении у сотрудника  с кодом 103; 201; 124. Результат сортировать по фамилии.
- Отобразите всех сотрудников (код, имя, фамилия), в фамилии которых третья буква А.
- Отобразите всех сотрудников (код, имя, фамилия), в фамилии которых содержатся буквы А,Е.
- Отобразите всех сотрудников (код, имя, фамилия, зарплата), имеющих должность SA_REP и ST_CLERK. Исключите также сотрудников с зарплатами 2500, 3500, 7000.
- Отобразите всех сотрудников (код, имя, фамилия, зарплата), у которых надбавка 0.20. 
- Создайте отчет, отображения фамилии, кода должности, зарплаты, надбавки, зарплаты с учетом надбавки у сотрудников, имеющих надбавку. 
- Напишите запрос, отражающих всех сотрудников, код занимаемой должности которых начинается на «SA_». В запросе отразите код сотрудника, его фамилию, код занимаемой должности.

### Lab 3 - Using Single-Row Functions to Customize Output
- Получите текущую дату, поле назовите Date.
- Отделу кадров требуется отчет, отображающий код сотрудника, фамилию, зарплату, зарплату умноженную на 1.155 (15.5%). Значение округлите до целого числа, назовите «New Salary».
- Напишите запрос, выводящий всех сотрудников вторая буква фамилии которых – а. Используйте функцию SUBSTR|SUBSTRING.
- Отделу кадров требуется отчет, отображающий код сотрудника, фамилию, зарплату, зарплату умноженную на 1.155 (15.5%), разницу между новой и старой зарплатой. Значения округлите до целого числа, назовите «New Salary», «Increase».
- Напишите запрос, показывающий фамилию, фамилию с большой буквы (используйте функцию INITCAP), длину фамилии в символах у всех сотрудников, фамилии которых начинаются на J, M, A. Результат отсортируйте возрастанию.
- Отдел кадров требует список сотрудников (фамилия, имя), количество отработанных месяцев в компании. Используйте функции ROUND, AGE, EXTRACT, NOW.
- Создайте отчет, выводящий предложение «<emp last name> earns <salary> monthly, but wants <3*salary>». Назовите колонку Dream Salary. Используйте функцию FORMAT.
- Отдел кадров требует список сотрудников (фамилия, имя), получаемую зарплату. Зарплата должна быть длинной 15 символов. Недостающую длину заполнить $ в начале. Используйте функции LPAD.
- Создайте отчет, выводящий предложение «<emp last name in upper case> earns <salary> monthly, but wants <3*salary>». Назовите колонку Dream Salary. Используйте функцию FORMAT, UPPER.
- Отдел кадров требует список сотрудников (фамилия, имя), количество отработанных месяцев в компании. Фамилия должна быть выведена заглавными буквами, а имя нет. Используйте функции ROUND, AGE, EXTRACT, NOW, UPPER, LOWER. 
- Отдел кадров требует список сотрудников (фамилия, имя), получаемую зарплату. Зарплата должна быть длинной 10 символов. Недостающую длину заполнить 0 в конце. Используйте функции RPAD.
- Напишите запрос, выводящий всю информацию из таблицы сотрудников, длина фамилии которых больше трех символов. Используйте функцию SUBSTR|SUBSTRING.
- Напишите запрос, выводящий всю информацию из таблицы сотрудников, длина фамилии которых больше трех символов. Используйте функцию LENGTH.
- Напишите запрос, выводящий всю информацию из таблицы сотрудников. Если фамилия начинается или заканчивается на букву K – выводить фамилию без этой буквы. Используйте функцию TRIM.
- Напишите запрос, выводящий всю информацию из таблицы сотрудников, в фамилии которых есть буквосочетание «in». Используйте функцию POSITION.
- Напишите запрос, выводящий всю информацию из таблицы сотрудников. Если в фамилии есть буквосочетание «in» - замените его на «pm». Используйте функцию REPLACE.
- Напишите запрос, выводящий всю информацию из таблицы сотрудников, в фамилии которых вторая буква - «i». Используйте функцию POSITION.
- Напишите запрос, выводящий всю информацию из таблицы EMPLOYEES одной колонкой. Назовите ее «THE OUTPUT». Используйте функцию CONCAT_WS.

### Lab 4 - Reporting Aggregated Data Using the Group Functions
- Напишите запрос, показывающий максимальную, минимальную, среднюю, а также сумму всех зарплат в таблице EMPLOYEES. Одним запросом. Колонки назвать соответственно Maximum, Minimum, Average, Sum. Результат округлить до целого числа.
- Напишите запрос, показывающий максимальную, минимальную, среднюю, а также сумму всех зарплат в таблице EMPLOYEES для каждой должности. Одним запросом. Колонки назвать соответственно Maximum, Minimum, Average, Sum. Результат округлить до целого числа.
- Выведете список должностей, с количеством человек, занимаемых эту должность.
- Выведете количество разных руководителей. Назовите колонку «Number Of Manager».
- Получите разницу между самой большой и самой маленькой зарплатой. Колонку назовите DIFFERENCE.
- Для каждого руководителя покажите минимальную зарплату в группе его подчиненных.
- Для каждого руководителя покажите минимальную зарплату в группе его подчиненных, начиная от 6000$. Исключите сотрудников, у которых нет руководителя. Полученные группу отсортируйте по убыванию.
- Для каждого руководителя покажите среднюю зарплату в группе его подчиненных.

### Lab 5 - Displaying Data from Multiple Tables
- Напишите запрос, показывающий адреса для всех подразделений. В запросе отразите location_id, улицу, город, штат, страну. Используйте NATURAL JOIN.
- Напишите запрос, показывающий информацию о сотрудниках. Запрос должен отображать фамилию, код подразделения (department_id), название подразделения.
- Напишите запрос, предоставляющий информацию о сотрудниках, находящихся в Торонто. В запросе отразите фамилию, код занимаемой должности, код подразделения (department_id), название подразделения.
- Напишите запрос, показывающий информацию о сотрудниках и их руководителях.  В запросе отразите код сотрудника, фамилию сотрудника, код руководителя, фамилию руководителя. 
- Основываясь на запросе в п.4, дополните его таким образом, чтобы выводились сотрудники, у которых нет руководителя.
- Напишите запрос, показывающий руководителей по каждому подразделению. Используйте таблицы departments, employees. В запросе покажите код подразделения, название подразделения, код сотрудника, его фамилию.
- Напишите запрос, отображающий информацию о подразделениях, их руководителей, входящих в состав подразделений сотрудников. В запросе отразите код подразделения, название подразделения, фамилию руководителя подразделения, код подчиненного сотрудника, фамилию подчиненного сотрудника.
- Напишите запрос, отображающий информацию о сотрудниках, которые были приняты на работу после того, как был принят сотрудник Davis. В запросе отразите код сотрудника, его фамилию, дату принятия на работу, дату принятия на работу Davis’а.
- Напишите запрос, отражающий информацию о сотрудниках, которые были приняты раньше, чем свои руководители. В запросе покажите код сотрудника, фамилию сотрудника, дату принятия на работу, фамилию руководителя, дату принятия на работу руководителя.
- Напишите запрос, отражающий количество сотрудников в каждом подразделении. В запросе покажите код подразделения, название подразделения, количество сотрудников, работающих в нем.
- Напишите запрос, отображающий информацию о сотрудниках, которые меняли свою работу более 1 раза. В запросе отразите код сотрудника, фамилию, количество должностей, занимаемых сотрудником.
- Напишите запрос, отображающий информацию о сотрудниках, зарплата которых больше, чем зарплата их руководителей. В запросе отразите код сотрудника, фамилию, код руководителя, фамилию руководителя.

### Lab 6 – Using queries to solve queries
- Напишите запрос, показывающий фамилию и дату принятия на работу у сотрудников, работающих с сотрудником  Zlotkey, исключая самого Zlotkey. Используйте подзапрос, для получения кода подразделения у сотрудника Zlotkey.
- Напишите запрос, показывающий всех сотрудников, получающих заработную плату выше средней. Полученный результат должен быть отсортирован по возрастанию заработной платы.
- Для каждого сотрудника покажите название отдела, в котором он работает. Используйте подзапрос для получения названия отдела.
- Напишите запрос, показывающий всех сотрудников, находящихся в подчинении у сотрудника с фамилией King.
- Напишите запрос, показывающий всех сотрудников, работающих в отделе Executive.
- Напишите запрос, показывающий всех сотрудников компании, получающих заработную плату выше средней и работающих в подразделении, у которого в названии содержится буква “u”.
- Для каждого подразделения покажите минимальную зарплату, среди сотрудников, получающих зарплату выше средней.
- Напишите запрос, отображающий все подразделения, в которых работают сотрудники с кодом занимаемой должности SA_REP. Код подразделения получите подзапросом.
- Для запроса из п.8 исключите сотрудников, у которых код подразделения не указан.

### Lab 7 – Using set operators
- Напишите запрос, отображающий список подразделений, не содержащих сотрудников с кодом должности ST_CLERK. Используйте конструкцию MINUS.
- Напишите запрос, отображающий список стран, в которых не расположены подразделения.
- Отобразите сотрудников, работающих в подразделениях 10, 20, 50. Используйте конструкцию UNION для объединения сотрудников из каждого подразделения.
- Напишите запрос, отображающий код сотрудника и код занимаемой должности для тех сотрудников, которые меняли работу, но вернулись к своей первоначальной должности. Используйте конструкцию INTERSECT.
